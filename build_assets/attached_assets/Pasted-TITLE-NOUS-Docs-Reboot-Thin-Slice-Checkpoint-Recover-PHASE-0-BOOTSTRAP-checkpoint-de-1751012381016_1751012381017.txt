TITLE: “NOUS Docs Reboot — Thin-Slice, Checkpoint, Recover”

## PHASE 0 · BOOTSTRAP  (checkpoint: deps-ok)
1. Update replit.nix:
   pkgs.python311Full  pkgs.graphviz  pkgs.git  pkgs.nodejs
2. `pip install --quiet pdoc markdown-link-check bandit flake8 flask-smorest apispec[marshmallow]`
      # pdoc ≈ 0-config API docs  [oai_citation:0‡pdoc.dev](https://pdoc.dev/docs/pdoc.html?utm_source=chatgpt.com)
3. `npm i -g markdown-link-check lighthouse-ci`  # link + perf audits  [oai_citation:1‡github.com](https://github.com/tcort/markdown-link-check?utm_source=chatgpt.com) [oai_citation:2‡github.com](https://github.com/GoogleChrome/lighthouse-ci?utm_source=chatgpt.com)

## PHASE 1 · INVENTORY  (checkpoint: map-ok)
• `git ls-files | grep -Ei '\.(md|rst|adoc)$'` → build **doc_map.json**  
• tag any filename containing *(doc|guide|notes|spec|howto)* as “custom-extra”.

## PHASE 2 · CODE-DRIVEN DOCS  (checkpoint: api-html)
A. **pdoc**  
   `pdoc --output-dir docs/_build/html nous_app` → fast HTML from docstrings  [oai_citation:3‡pdoc.dev](https://pdoc.dev/?utm_source=chatgpt.com)  
B. **OpenAPI** with **flask-smorest**  
   `python -m nous_app.scripts.generate_openapi` → `docs/api/openapi.yaml`; mount Swagger UI at `/docs/api`  [oai_citation:4‡flask-smorest.readthedocs.io](https://flask-smorest.readthedocs.io/en/latest/openapi.html?utm_source=chatgpt.com)  
C. **ER + Sequence**  
   Introspect SQLAlchemy → `docs/schema.mmd`; draw login→DB flow → `docs/flow.mmd` via Mermaid HTML.

*If pdoc fails, fallback:*  
   `pip install sphinx sphinx-autoapi sphinx_rtd_theme sphinxcontrib-mermaid` → run AutoAPI  [oai_citation:5‡github.com](https://github.com/readthedocs/sphinx-autoapi?utm_source=chatgpt.com) [oai_citation:6‡github.com](https://github.com/readthedocs/sphinx-autoapi/blob/master/docs/how_to.rst?utm_source=chatgpt.com)

## PHASE 3 · STANDARD FILES  (checkpoint: std-files)
Ensure/overwrite body (keep filenames/front-matter) for:  
README.md · CONTRIBUTING.md · LICENSE · CODE_OF_CONDUCT.md (Contributor Covenant v2.1)  [oai_citation:7‡github.com](https://github.com/GoogleChrome/lighthouse-ci?utm_source=chatgpt.com) · SECURITY.md · CHANGELOG.md (Keep-a-Changelog) · ARCHITECTURE.md (embed Mermaid diagrams).

## PHASE 4 · QUALITY GATES  (checkpoint: green)
1. `markdown-link-check '**/*.md' --quiet` — die on 4xx/5xx  [oai_citation:8‡github.com](https://github.com/tcort/markdown-link-check?utm_source=chatgpt.com)  
2. `bandit -r nous_app -o docs/reports/bandit.txt -lll` — no HIGH issues  [oai_citation:9‡bandit.readthedocs.io](https://bandit.readthedocs.io/?utm_source=chatgpt.com)  
3. `flake8 nous_app` — stylistic sanity  
4. `lhci autorun --staticDistDir=docs/_build/html --budgetPath=budgets.json` — perf ≥ 90 & a11y ≥ 90  [oai_citation:10‡github.com](https://github.com/GoogleChrome/lighthouse-ci?utm_source=chatgpt.com) [oai_citation:11‡github.com](https://github.com/GoogleChrome/lighthouse-ci/blob/main/README.md?utm_source=chatgpt.com)

*If Lighthouse bombs (>2 min): skip and log TODO.*

## PHASE 5 · CI/CD  (checkpoint: ci-ready)
Create `.github/workflows/docs.yml` that:
  • installs cached pip/node deps  
  • reruns phases 1-4  
  • deploys `docs/_build/html` → `gh-pages` via **peaceiris/actions-gh-pages**  [oai_citation:12‡github.com](https://github.com/peaceiris/actions-gh-pages?utm_source=chatgpt.com)  

## PHASE 6 · COMMIT
Replace bodies of every file listed in **doc_map.json** (keep names).  
Append CHANGELOG: “Full Flask + pdoc doc reboot – $(date +%Y-%m-%d)”.  
Commit: `docs(reboot): pdoc-based rebuild + checkpoints`.

ACCEPTANCE
✓ pdoc HTML loads; Swagger UI live  
✓ Bandit HIGH=0 ; markdown-link-check clean  
✓ README, LICENSE, CONTRIBUTING, CODE_OF_CONDUCT, SECURITY, CHANGELOG, ARCHITECTURE present and updated  
✓ Workflow pushes to `gh-pages` without error

END OF PROMPT