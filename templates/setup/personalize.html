{% extends "setup/layout.html" %}

{% block title %}Personalize Your Assistant{% endblock %}

{% block setup_content %}
<div class="setup-personalize">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="setup-card">
                <div class="setup-card-body">
                    <h2 class="setup-card-title">Personalize Your Assistant</h2>
                    <p class="text-center mb-4">Make your assistant truly yours by customizing its name, appearance, and personality.</p>
                    
                    <form action="{{ url_for('setup.personalize_save') }}" method="post" enctype="multipart/form-data">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="setup-form-group">
                                    <label for="assistant_name" class="setup-label">Assistant Name</label>
                                    <input type="text" class="form-control" id="assistant_name" name="assistant_name" 
                                           value="{{ profile.name if profile else 'NOUS' }}" 
                                           placeholder="e.g., NOUS, Jarvis, Friday" required>
                                    <small class="form-text text-muted">This is the internal name used by the system.</small>
                                </div>
                                
                                <div class="setup-form-group">
                                    <label for="display_name" class="setup-label">Display Name</label>
                                    <input type="text" class="form-control" id="display_name" name="display_name" 
                                           value="{{ profile.display_name if profile else 'NOUS' }}" 
                                           placeholder="e.g., NOUS Assistant, My Helper" required>
                                    <small class="form-text text-muted">This is what will be shown in the interface.</small>
                                </div>
                                
                                <div class="setup-form-group">
                                    <label for="tagline" class="setup-label">Tagline</label>
                                    <input type="text" class="form-control" id="tagline" name="tagline" 
                                           value="{{ profile.tagline if profile }}" 
                                           placeholder="e.g., Your personal AI assistant">
                                    <small class="form-text text-muted">A short description that appears below the name.</small>
                                </div>
                                
                                <div class="setup-form-group">
                                    <label for="description" class="setup-label">Description</label>
                                    <textarea class="form-control" id="description" name="description" rows="3" 
                                              placeholder="A brief description of your assistant's purpose and capabilities">{{ profile.description if profile }}</textarea>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="setup-form-group">
                                    <label for="primary_color" class="setup-label">Primary Color</label>
                                    <div class="d-flex align-items-center">
                                        <input type="color" class="form-control form-control-color" id="primary_color" name="primary_color" 
                                               value="{{ profile.primary_color if profile else '#6f42c1' }}" title="Choose your primary color">
                                        <div id="color-preview" class="color-preview"></div>
                                    </div>
                                    <small class="form-text text-muted">This color will be used throughout the interface.</small>
                                </div>
                                
                                <div class="setup-form-group">
                                    <label for="theme" class="setup-label">Theme</label>
                                    <select class="form-select" id="theme" name="theme">
                                        <option value="light" {% if profile and profile.theme == 'light' %}selected{% endif %}>Light</option>
                                        <option value="dark" {% if not profile or profile.theme == 'dark' %}selected{% endif %}>Dark</option>
                                    </select>
                                </div>
                                
                                <div class="setup-form-group">
                                    <label for="personality" class="setup-label">Personality</label>
                                    <select class="form-select" id="personality" name="personality">
                                        {% for option in personality_options %}
                                        <option value="{{ option.id }}" 
                                                {% if profile and profile.personality == option.id %}selected{% endif %}>
                                            {{ option.name }}
                                        </option>
                                        {% endfor %}
                                    </select>
                                    <small id="personality-description" class="form-text text-muted mt-2">
                                        {% if personality_options and personality_options|length > 0 %}
                                            {{ personality_options[0].description }}
                                        {% endif %}
                                    </small>
                                </div>
                                
                                <div class="setup-form-group">
                                    <label for="logo" class="setup-label">Logo Image (Optional)</label>
                                    <input type="file" class="form-control" id="logo" name="logo" accept="image/*">
                                    <small class="form-text text-muted">Upload a square image for best results.</small>
                                    
                                    {% if profile and profile.logo_path %}
                                    <div class="mt-2">
                                        <p>Current logo:</p>
                                        <img src="{{ profile.logo_path }}" alt="Current Logo" style="max-width: 100px; max-height: 100px;">
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="setup-nav">
                            <a href="{{ url_for('setup.welcome') }}" class="btn btn-outline-secondary">
                                <i class="fas fa-arrow-left me-2"></i> Back
                            </a>
                            <button type="submit" class="btn btn-primary">
                                Continue <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Update personality description when option changes
        const personalitySelect = document.getElementById('personality');
        const personalityDescription = document.getElementById('personality-description');
        
        if (personalitySelect && personalityDescription) {
            const personalities = {
                {% for option in personality_options %}
                '{{ option.id }}': '{{ option.description }}',
                {% endfor %}
            };
            
            personalitySelect.addEventListener('change', function() {
                personalityDescription.textContent = personalities[this.value] || '';
            });
        }
    });
</script>
{% endblock %}